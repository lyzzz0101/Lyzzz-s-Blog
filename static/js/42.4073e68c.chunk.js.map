{"version":3,"sources":["components/Articles/DVS/data.csv","components/Articles/DVS/DVS.jsx","components/_ui/Chart/Chart.jsx","components/_ui/Chart/Axis/Axis.jsx","components/_ui/Chart/Scatter/Scatter.jsx"],"names":["module","exports","__webpack_require__","p","formatNumberWithDecimal","d","numeral","format","axes","d3","range","domain","colorAxisScale","colors","grabColor","values","valueIndices","_","map","axis","i","mainAxis","maxBy","colorAxisScales","color","dateAccessor","date","DVS","_useState","useState","_useState2","Object","_Users_linying_codespace_Lyzzz_s_Blog_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_1__","data","setData","_useState3","_useState4","location","setLocation","useEffect","dataFile","then","rows","sortedData","orderBy","_Users_linying_codespace_Lyzzz_s_Blog_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__","react__WEBPACK_IMPORTED_MODULE_2___default","a","createElement","className","DVSLegend","length","DVSMap","DVSLocation","cities","logScaleDistance","Math","log10","_ref","_ref$data","_useState5","thisCity","dots","_useState6","state","setState","relativeLocations","findNewPoint","findAngle","wrapAroundLongitude","long","lat","findDistance","enhancedCities","city","baseDistance","angle","name","concat","country","angleSteps","PI","anglePadding","angleCities","filter","times","startAngle","endAngle","find","width","height","viewBox","fill","stroke","stroke-width","strokeLinecap","strokeLinejoin","points","key","style","transform","DvsMapDot","React","memo","_ref2","background","animationDelay","xDelta","yDelta","atan2","sqrt","pow","x","y","distance","round","cos","sin","center","value","bounds","_ref3","_useState7","_useState8","selectedCity","setSelectedCity","grabLocation","navigator","geolocation","getCurrentPosition","position","coords","latitude","longitude","join","components_ui_Button_Button__WEBPACK_IMPORTED_MODULE_9__","onClick","slice","axisIndex","require","getHeight","margin","arguments","undefined","top","bottom","max","getWidth","left","right","Chart","props","_this","_Users_linying_codespace_Lyzzz_s_Blog_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_1__","this","_super","call","setSize","_isMounted","_this$props","isLoaded","classNames","translate","WebkitTransform","_this2","_setSize","window","addEventListener","setTimeout","removeEventListener","_this$state","react__WEBPACK_IMPORTED_MODULE_5___default","id","_this$props2","hasNoListener","children","onMouseMove","line","area","bar","xAxis","yAxis","brush","hasTooltip","onMouseEnter","onMouseLeave","ref","getClassName","renderClipPath","getWrapperStyle","Component","defaultProps","noop","orientations","axesMap","Axis","elem","createRef","dimension","orientation","scale","tickSize","label","tickSizeInner","tickSizeOuter","ticks","tickFrequency","tickPadding","tickArguments","initTransition","transition","init","getOrientation","tickFormat","current","duration","update","newProps","_this$props3","hasInlineLabel","_classNames","_this$props4","_Users_linying_codespace_Lyzzz_s_Blog_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__","getStyle","renderLabel","Scatter","_Users_linying_codespace_Lyzzz_s_Blog_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__","radius","xAccessor","yAccessor","dataKey","easing","onUpdate","newDots","selectAll","enter","append","attr","merge","ease","exit","remove","on","console","log","prevProps","iterator","react__WEBPACK_IMPORTED_MODULE_4___default"],"mappings":"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","file":"static/js/42.4073e68c.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"c429755948f410cbc6ec31332cd87477.csv\";","import { useState, usePrevious, useEffect } from 'react';\nimport React, {Component} from \"react\"\nimport PropTypes from \"prop-types\"\nimport numeral from \"numeral\"\nimport domToImage from \"dom-to-image\"\nimport * as d3 from \"d3\"\nimport classNames from \"classnames\"\nimport _ from \"lodash\"\nimport Tooltip from \"components/_ui/Tooltip/Tooltip\"\nimport Button from \"components/_ui/Button/Button\"\nimport Chart from \"components/_ui/Chart/Chart\"\nimport Scatter from \"components/_ui/Chart/Scatter/Scatter\"\nimport Axis from \"components/_ui/Chart/Axis/Axis\"\nimport Slider from 'rc-slider';\nimport 'rc-slider/assets/index.css';\nimport dataFile from \"./data.csv\"\n\nimport './DVS.scss';\n\nconst formatNumber = d => numeral(d).format(\"0,0a\")\nconst formatNumberWithDecimal = d => numeral(d).format(\"0,0.0a\")\nconst ordinalColors = [\"#c7ecee\", \"#778beb\", \"#f7d794\", \"#63cdda\", \"#cf6a87\", \"#e77f67\", \"#786fa6\", \"#FDA7DF\", \"#4b7bec\", \"#778ca3\"];\nconst colorScale = d3.scaleLinear().range([\"#c7ecee\", \"#686de0\"]).domain([0, 1])\n\nconst axes = [\n  \"society\",\n  \"visualization\",\n  \"data\",\n]\nconst colorAxisScale = d3.scaleLinear()\n  .domain([0, 5])\n  .range([0, 1])\nconst colors = [\n  d3.interpolateRainbow(0.43),\n  d3.interpolateRainbow(0.76),\n  d3.interpolateRainbow(0.1),\n]\nconst grabColor = (values) => {\n  const valueIndices = _.map(axes, (axis, i) => [\n    i,\n    values[i]\n  ])\n  const mainAxis = _.maxBy(valueIndices, \"1\")\n  return colorAxisScales[mainAxis[0]](mainAxis[1])\n}\nconst colorAxisScales = colors.map(color => (\n  d3.interpolateHsl(\"#e2e4e7\", color)\n))\nconst dateAccessor = d => d3.timeParse(\"%m/%d/%Y\")(d.date)\nconst DVS = () => {\n  const [data, setData] = useState([])\n  const [location, setLocation] = useState([0, 0])\n\n  useEffect(() => {\n    d3.csv(dataFile).then(rows => {\n      const sortedData = _.orderBy(_.map(rows, d => ({\n        ...d,\n        color: grabColor(_.map(axes, axis => colorAxisScale(+d[axis] || 0))),\n      })), dateAccessor, \"asc\")\n      setData(sortedData)\n    })\n  }, [])\n\n  return (\n    <div className=\"DVS\">\n      <h2 className=\"DVS__title\">\n        Data Visualization Society\n      </h2>\n      <div className=\"DVS__contents\">\n      <div className=\"DVS__map\">\n\n        <div className=\"DVS__description\">\n          <p>\n            Over the past few weeks, 3,500 people have signed up for an invite to the <b>Data Visualization Society</b> to discuss, envision, and engage. Explore their expertise and location (log scaled and converted to polar coordinates) relative to you.\n          </p>\n\n          <DVSLegend />\n        </div>\n        {!data.length ? <div className=\"DVS__loading\">Loading...</div> : (\n          <DVSMap\n            data={data}\n            location={location}\n          />\n        )}\n        </div>\n        <DVSLocation\n          location={location}\n          setLocation={setLocation}\n        />\n      </div>\n    </div>\n  )\n}\n\nexport default DVS\n\n\nconst cities = [\n  [\"Amsterdam\", \"Netherlands\", 52.3680, 4.9036],\n  [\"Bangkok\", \"Thailand\", 13.7563, 100.5018],\n  [\"Barcelona\", \"Spain\", 41.3851, 2.1734],\n  [\"Beijing\", \"China\", 39.9042, 116.4074],\n  [\"Berlin\", \"Germany\", 52.5200, 13.4050],\n  [\"Bombay\", \"India\", 19.0760, 72.8777],\n  [\"Cape Town\", \"South Africa\", -33.9249, 18.4241],\n  [\"Copenhagen\", \"Denmark\", 55.6761, 12.5683],\n  [\"Helsinki\", \"Finland\", 60.1699, 24.9384],\n  [\"Lima\", \"Peru\", -12.0464, -77.0428],\n  [\"London\", \"England\", 51.5074, -0.1278],\n  [\"NYC\", \"USA\", 40.7128, -74.0060],\n  [\"Paris\", \"France\", 48.8566, 2.3522],\n  [\"Reykjavík\", \"Iceland\", 64.1466, -21.9426],\n  [\"Rio de Janeiro\", \"Brazil\", -22.9068, -43.1729],\n  [\"Rome\", \"Italy\", 41.9028, 12.4964],\n  [\"San Francisco\", \"USA\", 37.7749, -122.4194],\n  [\"Stockholm\", \"Sweden\", 59.3293, 18.0686],\n  [\"Sydney\", \"Australia\", -33.8688, 151.2093],\n  [\"Tokyo\", \"Japan\", 35.6895, 139.6917],\n  [\"Vancouver\", \"Canada\", 49.2827, -123.1207],\n  [\"Venice\", \"Italy\", 45.4408, 12.3155],\n  [\"Vienna\", \"Austria\", 48.2082, 16.3738],\n  [\"Zürich\", \"Switzerland\", 47.3769, 8.5417],\n]\n// [{\n//   name: \"NYC\",\n//   location: [40.7128, -74.0060],\n// },{\n//   name: \"LA\",\n//   location: [34.0522, -118.2437],\n// },{\n//   name: \"Philadelphia\",\n//   location: [39.9526, -75.1652],\n// // },{\n// //   name: \"Rochester\",\n// //   location: [43.1566, -77.6088],\n// },{\n//   name: \"Lima\",\n//   location: [-12.0464, -77.0428],\n// },{\n//   name: \"Berlin\",\n//   location: [52.5200, 13.4050],\n// },{\n//   name: \"Tokyo\",\n//   location: [35.6895, 139.6917],\n// }]\nconst logScaleDistance = d => d ? Math.log10(d) * 150 : 0\nconst DVSMap = ({ data=[], location }) => {\n  const [state, setState] = useState({\n    thisCity: null,\n    cities: [],\n    dots: [],\n  })\n\n  useEffect(() => {\n      const relativeLocations = _.map(data, d => ({\n          ...d,\n          location: findNewPoint(\n            0,\n            0,\n            findAngle(wrapAroundLongitude(location[1], +d.long), +d.lat - location[0]),\n            logScaleDistance(findDistance(wrapAroundLongitude(location[1], +d.long), +d.lat - location[0])),\n          ),\n      }))\n\n      const enhancedCities = cities.map(city => {\n        const baseDistance = findDistance(wrapAroundLongitude(location[1], city[3]), city[2] - location[0])\n        const angle = findAngle(wrapAroundLongitude(location[1], city[3]), city[2] - location[0])\n        const newLocation = findNewPoint(\n          0,\n          0,\n          angle,\n          logScaleDistance(baseDistance) + 50,\n        )\n\n        return {\n          angle,\n          location: newLocation,\n          baseDistance: baseDistance,\n          name: `${ city[0] }, ${ city[1] }`,\n          city: city[0],\n          country: city[1],\n        }\n      })\n\n      const numAngleSteps = 10\n      const angleSteps = (Math.PI * 2) / (numAngleSteps- 1)\n      const anglePadding = angleSteps * 0.1\n      const angleCities = _.filter(_.map(_.times(numAngleSteps), i => {\n        const startAngle = angleSteps * i - Math.PI + anglePadding\n        const endAngle = angleSteps * (i + 1) - Math.PI - anglePadding\n        const city = _.find(enhancedCities, d => d.baseDistance > 50 && d.angle > startAngle && d.angle < endAngle)\n        return city\n      }), d => d)\n\n      const thisCity = _.find(enhancedCities, d => d.baseDistance < 2)\n\n      setState({\n        thisCity,\n        cities: angleCities,\n        dots: relativeLocations,\n      })\n    }, [data, location])\n\n\n  return (\n    <div className=\"DVSMap\">\n      <div className=\"DVSMap__center\">\n        <div className=\"DVSMap__center__text\">\n        { state.thisCity && state.thisCity.city }\n        </div>\n        <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><path d=\"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z\"></path><polyline points=\"9 22 9 12 15 12 15 22\"></polyline></svg>\n      </div>\n      {_.map(state.cities, (d, i) => (\n        <div\n          className=\"DVSMap__location\"\n          key={d.name}\n          style={{\n            transform: `translate(${d.location[0]}px, ${d.location[1] * -1}px)`,\n          }}\n        >\n          <div className=\"DVSMap__location__arrow\" style={{\n            transform: `rotate(${-d.angle * (180 / Math.PI) - 90}deg)`\n          }} />\n          <div className=\"DVSMap__location__city\">{ d.city }</div>\n          <div className=\"DVSMap__location__country\">{ d.country }</div>\n        </div>\n      ))}\n      {_.map(state.dots, (d, i) => (\n        <DvsMapDot\n          key={i}\n          i={i}\n          color={d.color}\n          location={d.location}\n        />\n      ))}\n    </div>\n  )\n}\n\nconst DvsMapDot = React.memo(({ color, location, i }) => (\n  <div\n    className=\"DVSMap__dot\"\n    style={{\n      background: color,\n      transform: `translate(${location[0]}px, ${location[1] * -1}px)`,\n      animationDelay: `${i * 0.003}s`,\n    }}\n  />\n))\n\nconst findAngle = (xDelta, yDelta) => (\n  Math.atan2(yDelta, xDelta)\n)\nconst findDistance = (xDelta, yDelta) => (\n  Math.sqrt(Math.pow(xDelta, 2) + (Math.pow(yDelta, 2)))\n)\n\nconst findNewPoint = (x, y, angle, distance) => [\n  Math.round(Math.cos(angle) * distance + x),\n  Math.round(Math.sin(angle) * distance + y),\n]\n\nconst wrapAroundLongitude = (center, value) => {\n  const bounds = [center - 180, center + 180]\n  return value < bounds[0] ? (bounds[1] - (bounds[0] - value)) - center :\n         value > bounds[1] ? (center - (bounds[0] + (value - bounds[1]))) * -1 :\n         value - center\n}\n\nconst DVSLocation = ({ location, setLocation }) => {\n  const [selectedCity, setSelectedCity] = useState()\n\n  const grabLocation = () => {\n    navigator.geolocation.getCurrentPosition(position => {\n      setLocation([\n        position.coords.latitude,\n        position.coords.longitude,\n      ])\n      setSelectedCity()\n    })\n  }\n\n  useEffect(() => {\n    grabLocation()\n  }, [])\n\n  // const onLocationChange = index => value => {\n  //   const newLocation = index\n  //     ? [location[0], value]\n  //     : [value, location[1]]\n  //   setLocation(newLocation)\n  // }\n  const onSelectCity = city => () => {\n    setLocation(city.slice(2))\n    setSelectedCity(city[0])\n  }\n\n  return (\n    <div className=\"DVSLocation\">\n      <div className=\"DVSLocation__current\">\n        <i>Centered at { location.map(formatNumberWithDecimal).join(\", \") }</i>\n      </div>\n\n      <Button onClick={grabLocation}>\n        Grab my location\n      </Button>\n\n      <h6>\n        What about in...\n      </h6>\n\n      {_.map(cities, d => (\n        <Button className={`DVSLocation__city DVSLocation__city--is-${selectedCity == d[0] ? \"selected\" : \"not-selected\"}`} onClick={onSelectCity(d)}>\n          <div>{ d[0] }</div>\n          <div>{ d[1] }</div>\n        </Button>\n      ))}\n\n\n      {/* <Slider\n        value={[location[0]]}\n        min={-90}\n        max={90}\n        onChange={onLocationChange(0)}\n        pushable\n      />\n      <Slider\n        value={[location[1]]}\n        min={-180}\n        max={180}\n        onChange={onLocationChange(1)}\n        pushable\n      /> */}\n    </div>\n  )\n}\n\n\nconst DVSLegend = () => (\n  <div className=\"DVSLegend\">\n    <h6>Top skill</h6>\n    <div className=\"DVSLegend__axes\">\n      {_.map(axes, (axis, axisIndex) => (\n        <div className=\"DVSLegend__axis\" key={axis}>\n          <div className=\"DVSLegend__axis__name\">\n            { axis }\n          </div>\n          <div className=\"DVSLegend__axis__gradient\" style={{\n            background: `linear-gradient(to right, ${\n              _.map(_.times(10, i => colorAxisScales[axisIndex](i / 9))).join(\", \")\n            })`\n          }}>\n          </div>\n        </div>\n      ))}\n    </div>\n  </div>\n)","import React, {Component} from \"react\"\nimport PropTypes from \"prop-types\"\nimport classNames from \"classnames\"\nimport numeral from \"numeral\"\nimport _ from \"lodash\"\nimport * as d3 from \"d3\"\n\nrequire('./Chart.scss')\n\nexport const getHeight = (height, margin={top: 0, bottom: 0}) => Math.max(height - margin.top - margin.bottom, 0)\nexport const getWidth = (width, margin={left: 0, right: 0}) => Math.max(width - margin.left - margin.right, 0)\n\nclass Chart extends Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      height: this.props.height,\n      width: this.props.width,\n      isLoaded: false,\n    }\n  }\n\n  static propTypes = {\n    height: PropTypes.number,\n    width: PropTypes.number,\n    margin: PropTypes.shape({\n      top: PropTypes.number,\n      right: PropTypes.number,\n      bottom: PropTypes.number,\n      left: PropTypes.number,\n    }),\n    hasNoListener: PropTypes.bool,\n    onMouseMove: PropTypes.func,\n    onMouseEnter: PropTypes.func,\n    onMouseEnter: PropTypes.func,\n  };\n\n  static defaultProps = {\n    height: 200,\n    width: 600,\n    margin: {\n      top: 0,\n      right: 0,\n      bottom: 0,\n      left: 0,\n    },\n    onMouseMove: _.noop,\n    onMouseEnter: _.noop,\n    onMouseEnter: _.noop,\n};\n\n  getClassName() {\n    return classNames(\"Chart\", this.props.className)\n  }\n\n  getWrapperStyle() {\n    let {margin} = this.props\n    let translate = `translate3d(${margin.left}px, ${margin.top}px, 0)`\n    return {\n      transform: translate,\n      WebkitTransform: translate\n    }\n  }\n\n  setSize = () => {\n    if (!this._isMounted) return\n    let {height, width, margin} = this.props\n    this.setState({height: getHeight(height, margin)})\n    this.setState({width: getWidth(width, margin)})\n  }\n\n  componentWillMount() {\n    this.setSize()\n  }\n\n  componentDidMount() {\n    this._isMounted = true\n    this._setSize = this.setSize\n    window.addEventListener(\"resize\", this._setSize)\n    setTimeout(() => {\n      this.setState({isLoaded: true})\n    })\n  }\n\n  componentWillUnmount() {\n    this._isMounted = false\n    window.removeEventListener(\"resize\", this._setSize)\n  }\n\n  renderClipPath() {\n    let {height, width} = this.state\n    let {margin} = this.props\n\n    return <clipPath id=\"chartPath-clip\">\n      <rect className=\"Chart__clip-path\"\n        x={margin.left}\n        y={margin.top}\n        height={height}\n        width={width}\n      />\n    </clipPath>\n  }\n\n\n  render() {\n    const {height, width, margin, hasNoListener, children, line, area, bar, xAxis, yAxis, brush, hasTooltip, onMouseMove, onMouseEnter, onMouseLeave} = this.props\n\n    return (\n      <div ref=\"elem\" className={this.getClassName()}>\n        <svg className=\"Chart__svg\" height={height} width={width}>\n          <defs>\n            {this.renderClipPath()}\n          </defs>\n          <g className=\"Chart__wrapper\" style={this.getWrapperStyle()}>\n            {children}\n          </g>\n          {!hasNoListener && (\n            <rect\n              className=\"Chart__listener\"\n              x={margin.left}\n              y={margin.top}\n              height={getHeight(height, margin)}\n              width={getWidth(width, margin)}\n              onMouseMove={onMouseMove}\n              onMouseLeave={onMouseLeave}\n              onMouseEnter={onMouseEnter}\n            />\n          )}\n        </svg>\n      </div>\n    )\n  }\n}\n\nexport default Chart\n","import React, {Component} from \"react\"\nimport PropTypes from \"prop-types\"\nimport classNames from \"classnames\"\nimport * as d3 from \"d3\"\n\nrequire('./Axis.scss')\nconst orientations = {\n  x: \"bottom\",\n  y: \"left\"\n}\nconst axesMap = {\n  top: \"axisTop\",\n  left: \"axisLeft\",\n  right: \"axisRight\",\n  bottom: \"axisBottom\",\n}\n\nclass Axis extends Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      axis: null\n    }\n  }\n\n  static propTypes = {\n    width: PropTypes.number,\n    height: PropTypes.number,\n    scale: PropTypes.func,\n    margin: PropTypes.shape({\n      top: PropTypes.number,\n      right: PropTypes.number,\n      bottom: PropTypes.number,\n      left: PropTypes.number,\n    }),\n    dimension: PropTypes.oneOf([\"x\", \"y\"]),\n    orientation: PropTypes.oneOf([\"left\", \"right\", \"top\", \"bottom\"]),\n    ticks: PropTypes.number,\n    tickSize: PropTypes.number,\n    tickSizeInner: PropTypes.number,\n    tickSizeOuter: PropTypes.number,\n    tickFrequency: PropTypes.number,\n    tickArguments: PropTypes.array,\n    format: PropTypes.oneOfType([\n      PropTypes.func,\n      PropTypes.number,\n    ]),\n    initTransition: PropTypes.number,\n    transition: PropTypes.number,\n    label: PropTypes.string,\n    hasInlineLabel: PropTypes.bool,\n  };\n\n  static defaultProps = {\n    margin: {\n      top: 0,\n      right: 0,\n      bottom: 0,\n      left: 0,\n    },\n    ticks: 6,\n    tickSize: 0,\n    tickSizeInner: 6,\n    tickSizeOuter: 0,\n    initTransition: 300,\n    transition: 300\n  };\n  elem = React.createRef()\n\n  getStyle() {\n    const {height, width, margin, dimension} = this.props\n    const x = dimension == \"x\"      ? 0 :\n              margin.left           ? 1 :\n                                      width\n    const y = dimension == \"x\" ? height - margin.top - margin.bottom : 0\n\n    return {\n      transform: `translate3d(${x}px, ${y}px, 0)`\n    }\n  }\n\n  getOrientation() {\n    let {dimension, orientation} = this.props\n    return orientation || orientations[this.props.dimension] || \"left\"\n  }\n\n  update(props) {\n    let {scale, label, tickSize, tickSizeInner, tickSizeOuter, ticks, tickFrequency, tickPadding, tickArguments, format, initTransition, transition} = (props || this.props)\n    let {axis} = this.state\n    if (!scale) return\n\n    let init = !axis\n    if (init) axis = d3[axesMap[this.getOrientation()]]()\n\n    axis.scale(scale)\n        .tickSize(tickSize)\n        .tickSizeInner(tickSizeInner)\n        .tickSizeOuter(tickSizeOuter)\n\n    if (tickArguments) axis.tickArguments(tickArguments)\n    if (format) axis.tickFormat(format)\n    if (ticks) axis.ticks(ticks, tickFrequency)\n    if (tickPadding) axis.tickPadding(tickPadding)\n\n    d3.select(this.elem.current)\n      .transition().duration(init ? initTransition : transition)\n      .call(axis)\n\n    this.setState({axis})\n  }\n\n  componentDidMount() {\n    this.update()\n  }\n\n  componentWillReceiveProps(newProps) {\n    this.update(newProps)\n  }\n\n  renderLabel() {\n    let {dimension, label, width, hasInlineLabel} = this.props\n    let x =      dimension == \"x\" ? width - 100 || 0 : 0\n    let y =      dimension == \"x\" ? -10 :\n      hasInlineLabel ? 6 : 20\n    let rotate = dimension == \"x\" || hasInlineLabel ? 0 : -90\n\n    let style = {\n      transform: `rotate(${rotate}deg)`,\n    }\n    return <text\n      className={`Axis__label Axis--${dimension ? `${dimension}__` : ''}label`}\n      style={style}\n      x={x}\n      y={y}>\n      {label}\n    </text>\n  }\n\n  getClassName() {\n    let {dimension, hasInlineLabel, className} = this.props\n\n    return classNames(\n      \"Axis\", {\n        [`Axis--${dimension}`]: dimension,\n        [`Axis--has-inline-label`]: hasInlineLabel,\n      },\n      className\n    )\n  }\n\n  render() {\n    let {label} = this.props\n\n    return (\n      <g ref={this.elem} className={this.getClassName()} style={this.getStyle()}>\n        {!!label && this.renderLabel()}\n      </g>\n    )\n  }\n}\n\nexport default Axis\n","import React, {Component} from \"react\"\nimport PropTypes from \"prop-types\"\nimport classNames from \"classnames\"\nimport _ from \"lodash\"\nimport * as d3 from \"d3\"\n\nrequire('./Scatter.scss')\nconst orientations = {\n  x: \"bottom\",\n  y: \"left\"\n}\n\nclass Scatter extends Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      dots: null\n    }\n  }\n\n  static propTypes = {\n    data: PropTypes.array,\n    radius: PropTypes.oneOfType([\n      PropTypes.number,\n      PropTypes.func,\n    ]),\n    xAccessor: PropTypes.func,\n    yAccessor: PropTypes.func,\n    dataKey: PropTypes.func,\n    initTransition: PropTypes.number,\n    transition: PropTypes.number,\n    easing: PropTypes.func,\n    onUpdate: PropTypes.func,\n  };\n\n  static defaultProps = {\n    radius: 8,\n    initTransition: 1300,\n    transition: 300,\n    easing: d3.easeLinear,\n    onUpdate: _.noop,\n  };\n  elem = React.createRef()\n\n  update = () => {\n    let {data, radius, xAccessor, yAccessor, dataKey, initTransition, transition, easing, onUpdate} = this.props\n    let {dots} = this.state\n\n    let init = !dots\n    dots = d3.select(this.elem.current).selectAll(\".dot\")\n      .data((data || []), dataKey)\n\n    const newDots = dots.enter().append(\"circle\")\n      .attr(\"class\", \"dot\")\n\n    dots = newDots.merge(dots)\n\n    if (init) {\n      dots.attr(\"r\", 0)\n          .attr(\"cx\", xAccessor)\n          .attr(\"cy\", yAccessor)\n    }\n\n    dots.transition().duration(init ? initTransition : transition).ease(easing)\n        .attr(\"r\", radius)\n        .attr(\"cx\", xAccessor)\n        .attr(\"cy\", yAccessor)\n\n    dots.exit().remove()\n\n    dots.on(\"mouseenter\", d => console.log(d))\n\n    this.setState({dots})\n    onUpdate(dots)\n  }\n\n  componentDidMount() {\n    this.update()\n  }\n\n  componentDidUpdate(prevProps) {\n    if (\n      // this.props.data != prevProps.data ||\n      // this.props.xAccessor != prevProps.xAccessor ||\n      // this.props.yAccessor != prevProps.yAccessor ||\n      this.props.iterator != prevProps.iterator\n    ) this.update()\n  }\n\n  getClassName() {\n    return classNames(\n      \"Scatter\",\n      this.props.className\n    )\n  }\n\n  render() {\n    return (\n      <g ref={this.elem} className={this.getClassName()} />\n    )\n  }\n}\n\nexport default Scatter\n"],"sourceRoot":""}
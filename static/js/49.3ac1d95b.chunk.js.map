{"version":3,"sources":["components/Photoronoi/lincoln.png","components/Photoronoi/Photoronoi.jsx","components/_ui/Button/ButtonGroup/ButtonGroup.jsx","components/_ui/Toggle/Toggle.jsx"],"names":["module","exports","__webpack_require__","p","typeOptions","id","label","Photoronoi","canvas","useRef","svg","_useState","useState","_useState2","Object","_Users_linying_codespace_Lyzzz_s_Blog_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_3__","width","_useState3","_useState4","height","setHeight","_useState5","_useState6","strokeWidth","setStrokeWidth","_useState7","_useState8","dotsResolution","setDotsResolution","_useState9","_useState10","imageFile","setImageFile","_useState11","_useState12","type","setType","_useState13","_useState14","pixelArray","setPixelArray","_useState15","imageUrl","_useState16","fileUrl","setFileUrl","_useState17","_useState18","threshold","setThreshold","_useState19","_useState20","canvasOpacity","setCanvasOpacity","useEffect","isFinite","loadImage","image","window","Image","crossOrigin","src","context","current","getContext","clearRect","onload","sizeRatio","naturalWidth","naturalHeight","drawImage","imageData","getImageData","allValues","Array","from","data","pixelsPerRow","numberOfRows","Math","floor","length","_","times","i","valuesInRow","slice","r","g","b","a","_useMemo","useMemo","dots","voronoiPaths","forEach","row","rowIndex","darkness","random","push","x","y","color","delaunay","Delaunay","d","voronoi","map","_Users_linying_codespace_Lyzzz_s_Blog_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_2__","renderCell","voronoiPath","render","setFile","_ref","_Users_linying_codespace_Lyzzz_s_Blog_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__","_Users_linying_codespace_Lyzzz_s_Blog_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default","mark","_callee","e","wrap","_context","prev","next","target","files","abrupt","URL","createObjectURL","stop","_x","apply","this","arguments","react__WEBPACK_IMPORTED_MODULE_4___default","createElement","className","href","onSubmit","preventDefault","value","placeholder","onChange","components_ui_Button_Button__WEBPACK_IMPORTED_MODULE_7__","name","for","components_ui_Icon_Icon__WEBPACK_IMPORTED_MODULE_9__","rc_slider__WEBPACK_IMPORTED_MODULE_6__","min","max","step","pushable","components_ui_Toggle_Toggle__WEBPACK_IMPORTED_MODULE_8__","options","onClick","svgData","outerHTML","svgBlob","Blob","svgUrl","downloadLink","document","download","body","appendChild","click","removeChild","ref","style","opacity","xmlns","fill","stroke","React","memo","_ref2","key","cx","cy","_ref3","paths","concat","join","require","ButtonGroup","button","_this","props","classNames","Button--active","isActive","Button--inactive","_this2","buttons","getClassName","idx","_Button__WEBPACK_IMPORTED_MODULE_6__","getButtonClassName","disabled","isDisabled","children","Component","Toggle","_Users_linying_codespace_Lyzzz_s_Blog_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_1__","option","_Users_linying_codespace_Lyzzz_s_Blog_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__","react__WEBPACK_IMPORTED_MODULE_2___default","_Button_ButtonGroup_ButtonGroup__WEBPACK_IMPORTED_MODULE_5__","assign"],"mappings":"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","file":"static/js/49.3ac1d95b.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/lincoln.0a9ac95e.png\";","import React, { useEffect, useMemo, useRef, useState } from \"react\"\nimport _ from \"lodash\"\nimport Slider from 'rc-slider';\nimport Button from 'components/_ui/Button/Button';\nimport Toggle from 'components/_ui/Toggle/Toggle';\nimport Icon from 'components/_ui/Icon/Icon';\nimport 'rc-slider/assets/index.css';\nimport { Delaunay } from \"d3-delaunay\";\n\n// import imageUrl from \"./me.png\"\nimport imageUrl from \"./lincoln.png\"\n\nimport \"./Photoronoi.scss\"\n\n// const imageUrl = \"https://amp.businessinsider.com/images/5a81cbc2d030729f008b457d-750-563.jpg\"\nconst staticWidth = 900\n\nconst typeOptions = [{\n  id: \"delaunay\",\n  label: \"delaunay\",\n},{\n  id: \"voronoi\",\n  label: \"voronoi\",\n}]\n// const lineHeight = height / 100\nconst Photoronoi = () => {\n  const canvas = useRef()\n  const svg = useRef()\n  const [width, setWidth] = useState(staticWidth)\n  const [height, setHeight] = useState(900)\n  const [strokeWidth, setStrokeWidth] = useState(1)\n  const [dotsResolution, setDotsResolution] = useState(2)\n  const [imageFile, setImageFile] = useState(null)\n  const [type, setType] = useState(\"voronoi\")\n  const [pixelArray, setPixelArray] = useState([])\n  const [fileUrl, setFileUrl] = useState(imageUrl)\n  const [threshold, setThreshold] = useState(30)\n  const [canvasOpacity, setCanvasOpacity] = useState(0)\n\n  useEffect(() => {\n    if (!threshold || !isFinite(threshold) || threshold < 1) return\n    if (!dotsResolution || !isFinite(dotsResolution) || dotsResolution < 1) return\n    loadImage()\n  }, [threshold, dotsResolution, type, imageFile])\n\n  const loadImage = () => {\n    const image = new window.Image()\n    image.crossOrigin = '*'\n    image.src = imageFile || fileUrl\n    const context = canvas.current.getContext('2d')\n    context.clearRect(0, 0, width, height)\n\n    image.onload = function() {\n      const imageWidth = image.naturalWidth\n      const sizeRatio = staticWidth / imageWidth\n      const height = image.naturalHeight * sizeRatio\n      setHeight(height)\n\n      context.drawImage(image, 0, 0, width, height)\n      const imageData = context.getImageData(0, 0, width, height);\n      const allValues = Array.from(imageData.data)\n\n      const pixelsPerRow = width * 4\n      const numberOfRows = Math.floor(allValues.length / pixelsPerRow)\n      const numberOfColumns = Math.floor(allValues.length / (height * 4))\n      const pixelArray = _.times(numberOfRows, i => {\n        const valuesInRow = allValues.slice(pixelsPerRow * i, pixelsPerRow * (i + 1))\n        return _.times(valuesInRow.length / 4, i => ({\n          r: valuesInRow[i * 4 + 0],\n          g: valuesInRow[i * 4 + 1],\n          b: valuesInRow[i * 4 + 2],\n          a: valuesInRow[i * 4 + 3],\n        }))\n      })\n      setPixelArray(pixelArray)\n    }\n  }\n\n  const {\n    dots,\n    voronoiPaths,\n    voronoiPath,\n  } = useMemo(() => {\n    if (!pixelArray.length) return {\n      dots: [],\n      voronoiPaths: [],\n    }\n\n    let dots = []\n\n    pixelArray.forEach((row, rowIndex) => {\n      // only every nth row\n      if (rowIndex % dotsResolution) return\n\n      row.forEach((p, i) => {\n        // only every nth pixel\n        if (i % dotsResolution) return\n        if (p.a < 100) return\n\n        const darkness = p.r + p.b + p.g\n        const doesHaveDot = Math.random() * darkness < threshold\n        if (!doesHaveDot) return\n\n        dots.push({\n          x: i,\n          y: rowIndex,\n          color: p,\n        })\n      })\n    })\n\n    const delaunay = Delaunay.from(dots, d => d.x, d => d.y)\n    const voronoi = delaunay.voronoi([0, 0, width, height])\n    const voronoiPaths = dots.map((d, i) => ({\n      d: voronoi.renderCell(i),\n      ...d,\n    }))\n    // const voronoiPaths = dots.map((d, i) => delaunay.renderTriangle(i))\n    const voronoiPath = type == \"delaunay\" ? delaunay.render() : voronoi.render()\n\n    return {\n      dots,\n      voronoiPaths,\n      voronoiPath,\n    }\n  }, [pixelArray])\n\n  const onChangeImage = e => {\n    e.preventDefault()\n    loadImage()\n  }\n\n  const setFile = async e => {\n    const file = e.target.files[0];\n    if (!e.target.files[0]) return\n    setImageFile(URL.createObjectURL(e.target.files[0]))\n  }\n\n  const onDownload = () => {\n    const svgData = svg.current.outerHTML\n    const svgBlob = new Blob([svgData], {type:\"image/svg+xmlcharset=utf-8\"})\n    const svgUrl = URL.createObjectURL(svgBlob)\n    const downloadLink = document.createElement(\"a\")\n    downloadLink.href = svgUrl\n    downloadLink.download = \"Photoronoi.svg\"\n    document.body.appendChild(downloadLink)\n    downloadLink.click()\n    document.body.removeChild(downloadLink)\n  }\n\n  const onCopy = () => {\n    try {\n      const svgData = svg.current.outerHTML\n      console.log(svgData, typeof svgData)\n      var textField = document.createElement('textarea')\n      textField.innerText = svgData\n      document.body.appendChild(textField)\n      textField.select()\n      document.execCommand('copy')\n      textField.remove()\n    } catch(e) {\n      console.log(\"nope\", e)\n    }\n  }\n\n  return (\n    <div className=\"Photoronoi\">\n    <h3>\n      Photoronoi\n    </h3>\n    <p>\n      Upload an image or grab from a url to turn an image into a voronoi SVG.\n    </p>\n    <p>\n      Darker parts of the image result in smaller polygons - play around with the settings to see what works best for your picture! You might try removing the background of your image using <a href=\"http://remove.bg\">remove.bg</a>.\n    </p>\n    <div className=\"Photoronoi__controls\">\n      <div className=\"Photoronoi__field\">\n        <label>\n          Image url\n        </label>\n\n        <div className=\"Photoronoi__field__value\">\n          <form onSubmit={onChangeImage}>\n            <input value={fileUrl} placeholder=\"Image url\" onChange={e => {\n              setImageFile(null)\n              setFileUrl(e.target.value)\n            }} />\n            <Button type=\"submit\">Grab</Button>\n          </form>\n        </div>\n      </div>\n      <div className=\"Photoronoi__field\">\n        <label>\n          Upload\n        </label>\n        <div className=\"Photoronoi__field__value\">\n          <div className=\"Photoronoi__file\">\n            <input name=\"Photoronoi__file\" id=\"Photoronoi__file\" type=\"file\" onChange={setFile} />\n            <label for=\"Photoronoi__file\">\n              <Button>\n                <Icon name=\"upload\" />\n              </Button>\n            </label>\n          </div>\n        </div>\n      </div>\n      <div className=\"Photoronoi__field\">\n        <label>\n          Darkness threshold\n        </label>\n        <div className=\"Photoronoi__field__value\">\n          <input value={threshold} placeholder=\"threshold\" type=\"number\" onChange={e => {\n            const value = e.target.value\n            setThreshold(value)\n          }} />\n        </div>\n      </div>\n      <div className=\"Photoronoi__field\">\n        <label>\n          Image opacity\n        </label>\n        <div className=\"Photoronoi__field__value\">\n          <Slider\n            className=\"Photoronoi__slider\"\n            value={canvasOpacity}\n            min={0}\n            max={1}\n            step={0.05}\n            onChange={setCanvasOpacity}\n            pushable\n          />\n        </div>\n      </div>\n      <div className=\"Photoronoi__field\">\n        <label>\n          Stroke Width\n        </label>\n        <div className=\"Photoronoi__field__value\">\n          <Slider\n            className=\"Photoronoi__slider\"\n            value={strokeWidth}\n            min={0}\n            max={6}\n            step={0.5}\n            onChange={setStrokeWidth}\n            pushable\n          />\n        </div>\n      </div>\n      <div className=\"Photoronoi__field\">\n        <label>\n          Dots Resolution\n        </label>\n        <div className=\"Photoronoi__field__value\">\n          <Slider\n            className=\"Photoronoi__slider\"\n            value={dotsResolution}\n            min={1}\n            max={10}\n            step={1}\n            onChange={setDotsResolution}\n            pushable\n          />\n        </div>\n      </div>\n      <div className=\"Photoronoi__field\">\n        <label>\n          Type\n        </label>\n        <div className=\"Photoronoi__field__value\">\n          <Toggle\n            className=\"Photoronoi__slider\"\n            value={type}\n            options={typeOptions}\n            onChange={setType}\n          />\n        </div>\n      </div>\n      <div className=\"Photoronoi__field\">\n        <label>\n          Download\n        </label>\n        <div className=\"Photoronoi__field__value\">\n          <Button onClick={onDownload}>\n            <Icon name=\"download\" />\n          </Button>\n          {/* <Button onClick={onCopy}>\n            <Icon name=\"copy\" />\n          </Button> */}\n        </div>\n      </div>\n    </div>\n\n      <div className=\"Photoronoi__images\">\n        <canvas className=\"Photoronoi__canvas\" height={height} width={width} ref={canvas} style={{opacity: canvasOpacity}} />\n        <svg className=\"Photoronoi__svg\" xmlns=\"http://www.w3.org/2000/svg\" height={height} width={width} ref={svg}>\n          {/* <Dots {...{dots}} /> */}\n          {/* <Voronoi paths={voronoiPaths} strokeWidth={strokeWidth} /> */}\n          <path d={voronoiPath} fill=\"none\" stroke=\"#6a6a85\" strokeWidth={strokeWidth} />\n        </svg>\n      </div>\n    </div>\n  )\n}\n\nexport default Photoronoi\n\n\nfunction chunkArray(arr, chunkLength){\n    let results = []\n    while (arr.length) {\n        results.push(arr.splice(0, chunkLength))\n    }\n    return results\n}\n\nconst Dots = React.memo(({ dots }) => (\n  <g className=\"Dots\">\n    {dots.map((d, i) => (\n      <circle\n        key={i}\n        cx={d.x}\n        cy={d.y}\n        r={1}\n        // fill={`rgb(${[\n        //   d.color.r,\n        //   d.color.b,\n        //   d.color.g,\n        // ].join(\", \")})`}\n      />\n    ))}\n  </g>\n))\nconst Voronoi = React.memo(({ paths, strokeWidth }) => (\n  <g className=\"Voronoi\">\n    {paths.map((d, i) => (\n      <path\n        key={i}\n        d={d.d}\n        strokeWidth={strokeWidth}\n        fill={`rgb(${[\n          d.color.r,\n          d.color.b,\n          d.color.g,\n        ].join(\", \")})`}\n      />\n    ))}\n  </g>\n))\n\n\nconst readUploadedFileAsText = inputFile => {\n  const temporaryFileReader = new FileReader();\n\n  return new Promise((resolve, reject) => {\n    temporaryFileReader.onerror = () => {\n      temporaryFileReader.abort();\n      reject(new DOMException(\"Problem parsing input file.\"));\n    };\n\n    temporaryFileReader.onload = () => {\n      resolve(temporaryFileReader.result);\n    };\n    temporaryFileReader.readAsText(inputFile);\n  });\n};","import React, {Component} from \"react\"\nimport PropTypes from \"prop-types\"\nimport classNames from \"classnames\"\nimport Button from \"./../Button\"\n\nrequire('./ButtonGroup.scss')\n\nclass ButtonGroup extends Component {\n  static propTypes = {\n    buttons: PropTypes.array,\n    onChange: PropTypes.func\n  }\n\n  getClassName() {\n    return classNames(\n      \"ButtonGroup\", this.props.className\n    )\n  }\n\n  getButtonClassName(button) {\n    return classNames(button.className, {\n      \"Button--active\": button.isActive,\n      \"Button--inactive\": !button.isActive,\n    })\n  }\n\n  onChange = button => e => {\n    this.props.onChange(button, e)\n  }\n\n  render() {\n    let {buttons} = this.props\n\n    return (\n      <div className={this.getClassName()}>\n        {buttons.map((button, idx) =>\n          <Button type=\"button\"\n                  key={idx}\n                  className={this.getButtonClassName(button)}\n                  disabled={button.isDisabled}\n                  onClick={this.onChange(button)}>\n            {button.label || button}\n            {button.children}\n          </Button>\n        )}\n      </div>\n      )\n  }\n}\n\nexport default ButtonGroup\n","import React from 'react'\nimport _ from \"lodash\"\n\nimport './Toggle.scss'\nimport ButtonGroup from '../Button/ButtonGroup/ButtonGroup';\nimport Button from '../Button/Button';\n\nconst Toggle = ({ options, value, onChange, ...props }) => {\n    const onChangeLocal = button => onChange(button.id)\n\n    const buttons = options.map(option => ({\n        ...option,\n        isActive: option.id == value,\n    }))\n\n    return (\n        <ButtonGroup {...props}\n            buttons={buttons}\n            onChange={onChangeLocal}\n        />\n    )\n}\n\nexport default Toggle\n"],"sourceRoot":""}
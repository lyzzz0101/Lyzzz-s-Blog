(window.webpackJsonp=window.webpackJsonp||[]).push([[52],{1035:function(e,t,a){},1292:function(e,t,a){"use strict";a.r(t);var n=a(22),s=a.n(n),i=a(7),r=a(257),l=a(75),c=a(55),o=a(17),u=a(13),m=a(78),g=a(41),p=a(42),w=a(0),d=a.n(w),v=a(178),f=a.n(v),h=a(927),b=a.n(h),_=a(16),N=a.n(_),S=a(4),y=a(972),A=a.n(y),O=a(673),E=(a(638),a(1034)),C=a(670),j=a(95),k=a(179),B=new b.a({}),D=new A.a,F="https://cors-anywhere.herokuapp.com/";a(1035);var x=[{label:"The Atlantic",url:"https://www.theatlantic.com/feed/all/"},{label:"ABC",url:"http://feeds.abcnews.com/abcnews/topstories"},{label:"CBS",url:"https://www.cbsnews.com/latest/rss/main"},{label:"NBC",url:"https://www.nbcnewyork.com/news/top-stories/?rss=y"},{label:"BBC",url:"http://feeds.bbci.co.uk/news/rss.xml"},{label:"Reuters",url:"http://feeds.reuters.com/reuters/topNews/?format=xml"},{label:"Al Jazeera",url:"https://www.aljazeera.com/xml/rss/all.xml"},{label:"PBS Now",url:"http://www.pbs.org/now/rss.xml"},{label:"PBS Nova",url:"http://www.pbs.org/wgbh/nova/rss/nova.xml"}],L=new Date,I=N.a.map(x,function(e){return{label:e.label,isActive:!0}}),T=N.a.map(N.a.filter(I,"isActive"),"label"),U=[-100,100],R="active-sites",M="sentiment-range",P="last-load",J="title-filters",H=S.timeParse("%H:%M %m/%d/%Y"),z=S.timeFormat("%H:%M %m/%d/%Y"),V=3e5,W=function(e){Object(g.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).isFirstLoad=!0,n.getUrlArgs=function(){var e=window.location.search.slice(1).split("&");return N.a.fromPairs(e.map(function(e){return e.split("=").map(function(e,t){return 1==t?JSON.parse(window.decodeURIComponent(e)):window.decodeURIComponent(e)})}))},n.setUrlArg=function(e,t){var a=n.getUrlArgs(),s=N.a.omit(Object(c.a)(Object(c.a)({},a),{},Object(l.a)({},e,t)),""),i=n.state.activeSites;s&&i.length==x.length&&(s=N.a.omit(s,R)),window.history.replaceState({},"",N.a.isEmpty(s)?window.location.pathname:"?"+N.a.map(s,function(e,t){return"".concat(t,"=").concat(JSON.stringify(e))}).join("&"))},n.getFromStorage=function(e){return Object(k.b)("news--".concat(e))},n.setInStorage=function(e,t){return Object(k.d)("news--".concat(e),t)},n.setDefaults=function(){var e=n.getUrlArgs(),t=e[R]||n.getFromStorage(R)||T;N.a.isArray(t)||(t=T),e[R]&&n.setInStorage(R,t);var a=e[M]||n.getFromStorage(M)||U;N.a.isArray(a)||(a=U),e[M]&&n.setInStorage(M,a);var s=N.a.map(x,function(e){return{label:e.label,isActive:N.a.includes(t,e.label)}}),i=e[J]||n.getFromStorage(J)||[];N.a.isArray(i)||(i=[]),i.length&&N.a.isObject(i[0])&&(i=[]),e[J]&&n.setInStorage(J,i),n.setState({activeSites:t,siteOptions:s,sentimentRange:a,titleFilters:i})},n.parseArticles=function(e,t){return N.a.filter(N.a.map(e,function(e){return n.parseArticle(e,t)}),function(e){return!!e&&!N.a.startsWith(e.title,"WATCH: ")})},n.parseArticle=function(e,t){return Object(c.a)(Object(c.a)({},e),{},{site:t,pubDate:new Date(e.pubDate),hasBeenViewed:!!n.parsedLastLoad&&new Date(e.pubDate)<n.parsedLastLoad,sentiment:D.analyze([e.title,e.contentSnippet].join(". "))})},n.getNews=function(){x.map(function(){var e=Object(r.a)(s.a.mark(function e(t){var a,r,l;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.getFeed(t.url);case 2:a=e.sent,r=n.getFromStorage(P),n.parsedLastLoad=r?H(r):null,l=n.parseArticles(a.items||[],t.label),n.setState(function(e){var t=N.a.uniqBy(N.a.orderBy([].concat(Object(i.a)(l),Object(i.a)(e.articles)),"pubDate","desc"),function(e){return e.link}),a=N.a.countBy(t,function(e){return e.sentiment.score}),s=N.a.countBy(t,"site");if(n.isFirstLoad&&N.a.every(N.a.map(x,function(e){return!!s[e.label]}))){var r=z(new Date);n.setInStorage(P,r),n.isFirstLoad=!1}return{articles:t,isLoading:!1,articlesBySentiment:a,articlesBySite:s}});case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),n.timeout&&clearTimeout(n.timeout),n.timeout=setTimeout(n.getNews,V)},n.getFeed=function(){var e=Object(r.a)(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,B.parseURL("".concat(F).concat(t));case 3:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return",[]);case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t){return e.apply(this,arguments)}}(),n.onSiteChange=function(e){var t=n.state.activeSites.length==x.length,a=1==n.state.activeSites.length&&N.a.includes(n.state.activeSites,e.label),s=N.a.map(n.state.siteOptions,function(n){return Object(c.a)(Object(c.a)({},n),{},{isActive:!!a||(t?n.label==e.label:n.label==e.label?!n.isActive:n.isActive)})}),i=N.a.map(N.a.filter(s,"isActive"),"label");n.setInStorage(R,i),n.setUrlArg(R,i),n.setState({siteOptions:s,activeSites:i})},n.onSentimentRangeChange=function(e){var t=N.a.sortBy(e);n.setState({sentimentRange:t}),n.setInStorage(M,t),n.setUrlArg(M,t)},n.onIsDimmingSeenToggle=function(e){e.stopPropagation(),e.preventDefault();var t=!n.state.isDimmingSeen;n.setState({isDimmingSeen:t})},n.onIsShowingAboutToggle=function(){var e=!n.state.isShowingAbout;n.setState({isShowingAbout:e})},n.onTitleFilterChange=function(e){var t=N.a.map(e,"label");n.setState({titleFilters:t}),n.setInStorage(J,t),n.setUrlArg(J,t)},n.state={articles:[],titleFilters:[],articleTokens:[],siteOptions:I,activeSites:T,sentimentRange:U,articlesBySentiment:{},articlesBySite:{},isDimmingSeen:!0,isLoading:!0,isShowingAbout:!1},n.getNews=n.getNews.bind(Object(m.a)(n)),n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){this.setDefaults(),this.getNews()}},{key:"componentWillUnmount",value:function(){this.timeout&&clearTimeout(this.timeout)}},{key:"getClassName",value:function(){return f()("News")}},{key:"render",value:function(){var e=this.state,t=e.articles,a=e.siteOptions,n=e.activeSites,s=e.sentimentRange,i=e.articlesBySentiment,r=e.articlesBySite,l=(e.articleTokens,e.titleFilters),o=e.isDimmingSeen,u=e.isLoading,m=(e.isShowingAbout,N.a.filter(t,function(e){return N.a.includes(n,e.site)&&N.a.every(N.a.map(l,function(t){return!N.a.includes(N.a.lowerCase(e.title),t)}))&&(!e.sentiment||e.sentiment.score>s[0])&&(!e.sentiment||e.sentiment.score<s[1])})),g=N.a.groupBy(m,"hasBeenViewed"),p=g.true||[],w=g.false||[],v=N.a.max(Object.values(i)),f=N.a.map(l,function(e){return{label:e,value:e}});return d.a.createElement("div",{className:this.getClassName()},d.a.createElement("div",{className:"News__controls"},d.a.createElement(C.a,{className:"News__toggle",buttons:N.a.map(a,function(e){return Object(c.a)(Object(c.a)({},e),{},{children:r[e.label]?d.a.createElement("div",{className:"News__toggle__notification"},r[e.label]||0):d.a.createElement("div",{className:"News__toggle__loader"})})}),onChange:this.onSiteChange}),d.a.createElement("div",{className:"News__slider"},d.a.createElement("div",{className:"News__histogram"},N.a.map(N.a.range(200),function(e){return d.a.createElement("div",{className:"News__histogram__bar News__histogram__bar--is-".concat(e-100>s[0]&&e-100<s[1]?"showing":"not-showing"),key:e,style:{height:"".concat(i[e-100]?100*N.a.max([i[e-100],4])/v:0,"%")}})})),d.a.createElement("div",{className:"News__slider__values"},d.a.createElement("div",{className:"News__slider__value"},"Sentiment:"),d.a.createElement("div",{className:"News__slider__value"},s.join(" to "))),d.a.createElement(O.a,{value:s,min:-100,max:100,count:2,onChange:this.onSentimentRangeChange,pushable:!0,allowCross:!1}))),d.a.createElement("div",{className:"News__title-filter"},d.a.createElement("div",{className:"News__title-filter__title"},"Filter out articles containing strings:"),d.a.createElement(E.a,{className:"News__title-filter__input",classNamePrefix:"News__title-filter__input",value:f,onChange:this.onTitleFilterChange,isMulti:!0,isClearable:!0})),d.a.createElement("div",{className:"News__note"},"Showing ",m.length," of ",t.length," articles"),d.a.createElement("div",{className:"News__articles News__articles--is-".concat(o?"dimming-seen":"not-dimming-seen")},u&&d.a.createElement("div",{className:"News__note"},"Loading..."),w.map(function(e){return d.a.createElement(Y,{key:e.guid,article:e})}),!!p.length&&d.a.createElement("div",{className:"News__articles-separator"},d.a.createElement("div",{className:"News__articles-separator__text"},"Already seen"),d.a.createElement("div",{className:"News__articles-separator__line"}),d.a.createElement(j.a,{className:"News__articles-separator__toggle",onClick:this.onIsDimmingSeenToggle},o?"Don't":"Do"," dim")),p.map(function(e){return d.a.createElement(Y,{key:e.guid,article:e})})))}}]),a}(w.Component);t.default=W;var Y=function(e){var t=e.article;return d.a.createElement("a",{className:["NewsArticle","NewsArticle--is-".concat(t.hasBeenViewed?"not-new":"new")].join(" "),href:t.link,target:"_blank"},d.a.createElement("div",{className:"NewsArticle__title"},d.a.createElement("div",{className:"NewsArticle__title__label",dangerouslySetInnerHTML:{__html:t.title}}),d.a.createElement("div",{className:"NewsArticle__site"},t.site),d.a.createElement("div",{className:"NewsArticle__date"},function(e){var t=Math.round((L-e)/864e5),a=Math.round((L-e)/36e5),n=Math.round((L-e)/6e4);return n<10?"":a<1?"".concat(n,"m"):a<24?"".concat(a,"h"):t<1?"".concat(a,"h"):t<30?"".concat(t,"d"):S.timeFormat("%-m/%-d/%Y")(e)}(t.pubDate))),d.a.createElement("div",{className:"NewsArticle__snippet"},t.contentSnippet.slice(0,200)),d.a.createElement("div",{className:"NewsArticle__sentiment"},"Sentiment: ",t.sentiment&&t.sentiment.score))}},670:function(e,t,a){"use strict";var n=a(17),s=a(13),i=a(41),r=a(42),l=a(0),c=a.n(l),o=a(178),u=a.n(o),m=a(95);a(683);var g=function(e){Object(i.a)(a,e);var t=Object(r.a)(a);function a(){var e;Object(n.a)(this,a);for(var s=arguments.length,i=new Array(s),r=0;r<s;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).onChange=function(t){return function(a){e.props.onChange(t,a)}},e}return Object(s.a)(a,[{key:"getClassName",value:function(){return u()("ButtonGroup",this.props.className)}},{key:"getButtonClassName",value:function(e){return u()(e.className,{"Button--active":e.isActive,"Button--inactive":!e.isActive})}},{key:"render",value:function(){var e=this,t=this.props.buttons;return c.a.createElement("div",{className:this.getClassName()},t.map(function(t,a){return c.a.createElement(m.a,{type:"button",key:a,className:e.getButtonClassName(t),disabled:t.isDisabled,onClick:e.onChange(t)},t.label||t,t.children)}))}}]),a}(l.Component);t.a=g},683:function(e,t,a){},934:function(e,t){},936:function(e,t){},979:function(e,t,a){var n={"./en/index":814};function s(e){var t=i(e);return a(t)}function i(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}s.keys=function(){return Object.keys(n)},s.resolve=i,e.exports=s,s.id=979}}]);
//# sourceMappingURL=52.c1675a44.chunk.js.map